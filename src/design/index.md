### 設計

- ユーザーは目的をAに伝える、目的のすべてに共通するのは、エージェントに目的を達成するようファイル更新を行い、gitコミットを更新することである
- Aは[[triage_agent]]を選択できる
- 選択された[[triage_agent]]が動作される
- [[triage_agent]]は[[specialist_agent]]にタスクを移行できる
- もし閾値以下の点数だった場合、ユーザーにドキュメントの充実を依頼しつつセッションを終了する
- この閾値を満たしたとき、各[[specialist_agent]]が動作される

- 各[[specialist_agent]]は以下の動作ができる
  - 既定で与えられたドキュメント情報を保持する
  - 最初に[[evaluation_agent]]に一度操作を移行する、[[evaluation_agent]]は選択した[[specialist_agent]]が保持するドキュメント情報が十分であるかの点数をつける役割を担う
  - 移行時に与えられた目的情報を保持する
  - [[specialist_agent]]のタスクの最後に[[evaluation_agent]]へ操作を移行する、[[evaluation_agent]]は動作完了を判断した[[specialist_agent]]が保持するドキュメント・与えられた目的情報・更新前ファイル情報・更新後ファイル情報から、[[specialist_agent]]とともに評価値を算出し、指定された保存先へ保存する
    <!-- TODO: エラー処理の明確化: 各エージェントにおけるエラー処理（例：ファイルアクセスエラー、Gitコミットエラー）を詳細に記述する -->
    <!-- TODO: 評価指標の詳細化: [[evaluation_agent]]が使用する評価指標を具体的に定義する。点数付けの基準、重み付けなどを明確にする -->
    <!-- TODO: エージェント間の通信機構: エジェント間の通信方法（例：メッセージキュー、共有メモリ）を明確にする -->
    <!-- TODO: 閾値の設定根拠: 閾値の設定根拠を明確にする。データに基づいた根拠を示す必要がある -->
    <!-- TODO エラー処理の明確化: 各エージェントがエラー処理を詳細に記述する必要があります。 特に「ファイルアクセスエラー」「Gitコミットエラー」など、特定のエラーシナリオについての対処方法を定義します。 -->
    <!-- TODO 評価指標の詳細化: [[evaluation_agent]]が点数をつける際の基準や評価指標を具体的に設定します。 点数付けに関する重み付けの基準や計算方法も、統一された基準を設ける必要があります。 -->
    <!-- TODO エージェント間の通信機構: エージェント間でのデータのやり取り方法（例：メッセージキューや共有メモリ）について、通信の流れと方法を明確にします。 各エージェントが一貫して動作するための具体的な通信手段の決定が必要です。 -->
    <!-- TODO閾値の設定根拠: 「閾値」の数値や評価基準を設定する際の根拠を、具体的なデータや指標に基づいて明確にします。 実際のパフォーマンスデータなどを用いた根拠が必要です。 -->

```mermaid
sequenceDiagram
    participant ユーザー
    participant トリアージエージェント
    participant スペシャリストエージェント
    participant 評価エージェント
    
    ユーザー->>トリアージエージェント: 目的を伝える
    activate トリアージエージェント
    トリアージエージェント->>トリアージエージェント: スペシャリストエージェントを選択
    トリアージエージェント->>スペシャリストエージェント: タスクを移行
    deactivate トリアージエージェント
    activate スペシャリストエージェント
    スペシャリストエージェント->>評価エージェント: ドキュメント情報と目的情報を渡す
    activate 評価エージェント
    評価エージェント->>評価エージェント: ドキュメント情報の評価
    評価エージェント-->>スペシャリストエージェント: 評価結果を返す
    deactivate 評価エージェント
    alt 閾値を満たさない
        トリアージエージェント->>ユーザー: ドキュメント充実依頼
    else 閾値を満たす
        スペシャリストエージェント->>スペシャリストエージェント: ファイル更新とGitコミット
        スペシャリストエージェント->>評価エージェント: 更新前ファイル情報、更新後ファイル情報、目的情報を渡す
        activate 評価エージェント
        評価エージェント->>評価エージェント: 評価値を算出
        評価エージェント->>評価エージェント: 評価値を保存
        deactivate 評価エージェント
        deactivate スペシャリストエージェント
    end
